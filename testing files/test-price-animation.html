<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Price Update Animation</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
        .success { color: green; }
        .error { color: red; }
        .info { color: blue; }
        .book-details { 
            background: #f8f9fa; 
            padding: 20px; 
            border-radius: 8px; 
            margin: 20px 0;
        }
        .price-quantity { 
            display: flex; 
            align-items: center; 
            gap: 20px; 
            margin: 15px 0;
        }
        .price { 
            font-size: 24px; 
            font-weight: bold; 
            color: #007bff;
            transition: all 0.3s ease;
        }
        .quantity-control { display: flex; align-items: center; gap: 10px; }
        .quantity-control input { 
            width: 80px; 
            padding: 8px; 
            border: 1px solid #ddd; 
            border-radius: 4px;
            transition: all 0.3s ease;
        }
        .quantity-control input:focus {
            border-color: #007bff;
            box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.25);
            outline: none;
        }
        .test-instructions { 
            background: #e7f3ff; 
            padding: 15px; 
            border-radius: 8px; 
            margin: 20px 0;
        }
        .console-output { 
            background: #f5f5f5; 
            padding: 10px; 
            border-radius: 4px; 
            font-family: monospace; 
            font-size: 12px; 
            max-height: 200px; 
            overflow-y: auto;
        }
        
        /* Price Update Animation */
        .price-update-animation {
            animation: priceUpdate 0.5s ease-in-out;
        }
        
        @keyframes priceUpdate {
            0% {
                transform: scale(1);
                color: #007bff;
            }
            50% {
                transform: scale(1.1);
                color: #28a745;
                font-weight: bold;
            }
            100% {
                transform: scale(1);
                color: #007bff;
            }
        }
        
        .demo-books {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .demo-book {
            border: 1px solid #ddd;
            padding: 15px;
            border-radius: 8px;
            background: white;
        }
        .demo-book h4 { margin: 0 0 10px 0; }
        .demo-book .price { font-size: 18px; margin: 10px 0; }
        .demo-book input { width: 60px; }
    </style>
</head>
<body>
    <h1>Test Price Update Animation</h1>
    
    <div class="test-instructions">
        <h3>Test Instructions:</h3>
        <ol>
            <li>Change the quantity in any book below</li>
            <li>Watch the price animate and update immediately</li>
            <li>The price should scale up, turn green, then return to normal</li>
            <li>This works for all books independently</li>
        </ol>
    </div>
    
    <div class="test-section">
        <h2>Main Book (THE LEGEND OF RAVANA)</h2>
        <div class="book-details">
            <h3>THE LEGEND OF RAVANA</h3>
            <p>by Nalin Goonewardene</p>
            <div class="price-quantity">
                <span class="price" id="bookPrice1">Rs. 1900.00</span>
                <div class="quantity-control">
                    <label for="quantity1">Quantity:</label>
                    <input type="number" id="quantity1" name="quantity" value="1" min="1">
                </div>
            </div>
            <p>Nalin Goonewardene's book masterfully humanizes King Ravana and relates his struggles to protect his family and values.</p>
        </div>
    </div>
    
    <div class="test-section">
        <h2>Multiple Books Test</h2>
        <div class="demo-books">
            <div class="demo-book">
                <h4>Book 1: Sample Novel</h4>
                <p>Author: John Doe</p>
                <div class="price" id="bookPrice2">Rs. 1500.00</div>
                <label>Quantity: <input type="number" id="quantity2" value="1" min="1"></label>
            </div>
            <div class="demo-book">
                <h4>Book 2: Mystery Thriller</h4>
                <p>Author: Jane Smith</p>
                <div class="price" id="bookPrice3">Rs. 2200.00</div>
                <label>Quantity: <input type="number" id="quantity3" value="1" min="1"></label>
            </div>
            <div class="demo-book">
                <h4>Book 3: Science Fiction</h4>
                <p>Author: Bob Wilson</p>
                <div class="price" id="bookPrice4">Rs. 1800.00</div>
                <label>Quantity: <input type="number" id="quantity4" value="1" min="1"></label>
            </div>
        </div>
    </div>
    
    <div class="test-section">
        <h2>Debug Console Output</h2>
        <div id="console-output" class="console-output">
            <p>Console output will appear here...</p>
        </div>
        <button onclick="clearConsole()">Clear Console</button>
    </div>

    <script>
        // Book data
        const books = [
            { id: 1, title: "THE LEGEND OF RAVANA", author: "Nalin Goonewardene", price: 1900.00 },
            { id: 2, title: "Sample Novel", author: "John Doe", price: 1500.00 },
            { id: 3, title: "Mystery Thriller", author: "Jane Smith", price: 2200.00 },
            { id: 4, title: "Science Fiction", author: "Bob Wilson", price: 1800.00 }
        ];
        
        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            console.log("Test page loaded - initializing...");
            addToConsole("Test page loaded - initializing...");
            
            // Initialize all quantity inputs
            books.forEach(book => {
                initializeBookQuantity(book);
            });
        });
        
        // Initialize quantity handler for a specific book
        function initializeBookQuantity(book) {
            const quantityInput = document.getElementById(`quantity${book.id}`);
            const bookPrice = document.getElementById(`bookPrice${book.id}`);
            
            if (quantityInput && bookPrice) {
                // Add event listeners for real-time updates
                quantityInput.addEventListener('change', () => updateBookPrice(book));
                quantityInput.addEventListener('input', () => updateBookPrice(book));
                
                // Add visual feedback for quantity changes
                quantityInput.addEventListener('focus', function() {
                    this.style.borderColor = '#007bff';
                    this.style.boxShadow = '0 0 0 2px rgba(0, 123, 255, 0.25)';
                });
                
                quantityInput.addEventListener('blur', function() {
                    this.style.borderColor = '#ddd';
                    this.style.boxShadow = 'none';
                });
                
                console.log(`Initialized book ${book.id}: ${book.title}`);
                addToConsole(`Initialized book ${book.id}: ${book.title}`);
                
                // Initial price calculation
                updateBookPrice(book);
            }
        }
        
        // Update price for a specific book with animation
        function updateBookPrice(book) {
            const quantityInput = document.getElementById(`quantity${book.id}`);
            const bookPrice = document.getElementById(`bookPrice${book.id}`);
            
            if (quantityInput && bookPrice) {
                const quantity = parseInt(quantityInput.value) || 1;
                const totalPrice = book.price * quantity;
                const newPriceText = `Rs. ${totalPrice.toFixed(2)}`;
                
                // Add animation class for price update
                bookPrice.classList.add('price-update-animation');
                
                // Update the price with animation
                bookPrice.textContent = newPriceText;
                
                // Remove animation class after animation completes
                setTimeout(() => {
                    bookPrice.classList.remove('price-update-animation');
                }, 500);
                
                console.log(`Book ${book.id} (${book.title}): Quantity ${quantity} → Price ${totalPrice}`);
                addToConsole(`Book ${book.id} (${book.title}): Quantity ${quantity} → Price ${totalPrice}`);
            }
        }
        
        // Helper function to add messages to the console output div
        function addToConsole(message) {
            const consoleOutput = document.getElementById('console-output');
            const timestamp = new Date().toLocaleTimeString();
            consoleOutput.innerHTML += `<div>[${timestamp}] ${message}</div>`;
            consoleOutput.scrollTop = consoleOutput.scrollHeight;
        }
        
        // Clear console output
        function clearConsole() {
            document.getElementById('console-output').innerHTML = '<p>Console cleared...</p>';
        }
        
        // Override console.log to also show in our div
        const originalConsoleLog = console.log;
        console.log = function(...args) {
            originalConsoleLog.apply(console, args);
            addToConsole(args.join(' '));
        };
        
        // Override console.error to also show in our div
        const originalConsoleError = console.error;
        console.error = function(...args) {
            originalConsoleError.apply(console, args);
            addToConsole("ERROR: " + args.join(' '));
        };
    </script>
</body>
</html> 